<% if params[:team_id] == nil %>

  <p> Teams List </p>
  <% @teams.each do |team| %>
    <%= link_to team.team_name, '/items/list_by_team?team_id=' + String(team.id) %>
    <br>
  <% end %>

<% else %>

  <p> Team: <%= @team.team_name %> </p>

  <% if @requests.empty? %>
    <p> No requests yet! </p>
  <% else %>
    <table>
      <tr>
        <th> Item Name </th>
        <th> Requested </th>
        <th> Approved </th>
        <th> To Approve</th>
        <th> Init. Allotted </th>
        <th> Init. Allott </th>
        <th> Approve </th>
        <th> Return </th>
      </tr>
    <% @requests.each do |request| %>
      <tr>
        <td> <%= request.item.item_name %> </td>
        <td> <%= request.requested %> </td>
        <td> <%= request.approved %> </td>
        <td> <%= request.requested - request.approved %> </td>
        <td>
          <%= form_tag(:action => 'approve') do %>
            <%= number_field_tag('toApprove', params[:toApprove], :placeholder => 'Number to approve') %>
            <%= hidden_field_tag('team_id', params[:team_id] = request.team_id) %>
            <%= hidden_field_tag('item_id', params[:item_id] = request.item_id) %>
            <%= hidden_field_tag('request_id', params[:request_id] = request.id) %>
            <%= submit_tag('Approve') %>
          <% end %>
        </td>
        <td>
          <%= form_tag(:action => 'return') do %>
            <%= number_field_tag('toReturn', params[:toReturn], :placeholder => 'Number to return') %>
            <%= hidden_field_tag('team_id', params[:team_id] = request.team_id) %>
            <%= hidden_field_tag('item_id', params[:item_id] = request.item_id) %>
            <%= hidden_field_tag('request_id', params[:request_id] = request.id) %>
            <%= submit_tag('Return') %>
          <% end %>
        </td>
        <td>
          <% if @request.item_allotted == 0 %>
            <%= form_tag(:action => 'Allott') do %>
              <%= number_field_tag('toReturn', params[:toAllot], :placeholder => 'Number to return') %>
              <%= hidden_field_tag('team_id', params[:team_id] = request.team_id) %>
              <%= hidden_field_tag('item_id', params[:item_id] = request.item_id) %>
              <%= hidden_field_tag('request_id', params[:request_id] = request.id) %>
              <%= submit_tag('Return') %>
            <% end %>
          <% end %>
        </td>
      </tr>
    <% end %>
    </table>
  <% end %>

<% end %>
